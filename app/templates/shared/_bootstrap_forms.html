{% macro render_inline_field(field) %}
<div class="form-group">
  {{ field(**kwargs)|safe }}
  {% if field.errors %}
  {% for error in field.errors %}
    <div class="label label-danger">{{ error }}</div><br/>
  {% endfor %}
  {% endif %}
</div>
{% endmacro %}

{% macro render_normal_field(field, field_width=10, label_width=2, wrap_class='') %}
<div class="form-group">
  <label class="col-lg-{{label_width}} control-label">{{field.label}}</label>
  <div class="col-lg-{{field_width}}">
    {% if wrap_class!='' %}
    <div class="{{wrap_class}}">
      {{ field(**kwargs)|safe }}
    </div>
    {% else %} 
    {{ field(**kwargs)|safe }}
    {% endif %}
    
    {% if field.errors %}
    {% for error in field.errors %}
      <div class="label label-danger">{{ error }}</div><br/>
    {% endfor %}
    {% endif %}        
  </div>
</div>
{% endmacro %}

{% macro render_comment(comment, current_user, post, recursive = False) %}
<article id="comment_{{comment.id}}" class="comment {{ 'reply' if recursive }}">
  {% if recursive %}<hr class="line" />{% endif %}
  <header class="clearfix">
    <img src="{{ comment.user.avatar(64) }}" alt="{{ _('User: %(user)s', user=comment.user.name) }}" class="avatar">
    <div class="meta">
      <div class="row">
        <div class="col-md-9">
          <h3>{{ comment.user.name }} ({{ comment.user.nickname }})</h3>
          <span class="date">
            {{ comment.created_at | datetimeformat('d MMM yyyy, H:mm')}}
          </span>                
        </div>
        <div class="col-md-3">
          {% if current_user.is_authenticated %}
          <form class="pull-right" action="{{ url_for('reply_comment', post_id=post.id, id=comment.id) }}" data-remote="true" method="GET">
            <input class="btn btn-primary" name="commit" type="submit" value="{{_('Reply')}}">
          </form>
          {% endif %}                
        </div>
      </div>
    </div>
  </header>
  <div class="body">
    {{ comment.body | safe }}
  </div>
  <div class="reply">            
  </div>
</article>
{% if comment.replies.count() > 0 %}
{% for reply in comment.replies %}
{{ render_comment(reply, current_user, post, recursive = True) }}
{% endfor %}
{% endif %}
{% endmacro %}

{% macro render_search_field(field) %}
{{ field(**kwargs)|safe }}
{% if field.errors %}
{% for error in field.errors %}
  <div class="label label-danger">{{ error }}</div><br/>
{% endfor %}
{% endif %}
{% endmacro %}